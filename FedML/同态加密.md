# 同态加密
## 1、Shamir's Secret Sharing
Shamir's Secret Sharing是一种加密技术，用于将一个秘密分成多份，并分配给多个参与者。其中，Shamir's (t-out-of-n) Secret Sharing是一种特殊的Shamir's Secret Sharing，它将秘密分成t份，并将这些份分配给n个参与者。只有当其中至少t个参与者共同合作时，才能重建秘密。

具体而言，Shamir's (t-out-of-n) Secret Sharing是通过在一个有限域上进行多项式插值实现的。假设需要将一个秘密s分成t份，并将这些份分配给n个参与者。则可以生成一个t-1次多项式f(x)，满足f(0) = s。然后，将这个多项式f(x)的系数随机地分成n份，并分配给n个参与者。每个参与者收到一个系数向量，以及一个对应的x值。当至少t个参与者将他们的系数向量进行组合时，就可以重建出多项式f(x)的系数，从而得到秘密s。

Shamir's Secret Sharing可以用于保护密钥、密码、数字签名等重要信息的安全性，同时也可以用于构建安全多方计算协议和分布式控制协议。
### Q1 举例说明过程

假设现在有一个秘密 $s=12$ 需要被共享给五个参与者，并且要求其中任意三个参与者可以恢复出这个秘密。那么这个过程可以分成以下步骤：

1. 生成一个 2 阶多项式，使得 $f(0) = s$，即 $f(x)=s+ax+bx^2$，其中 $a,b$ 是多项式的系数。
2. 为了实现 Shamir's Secret Sharing，需要在 $x=1,2,3,4,5$ 处对多项式 $f(x)$ 进行求值，并将这些值发送给对应的参与者。
3. 假设现在有三个参与者想要重建出秘密 $s$。他们可以使用拉格朗日插值法，使用任意三个点求出多项式 $f(x)$ 的系数 $a,b$，从而得到多项式 $f(x)$。然后他们可以计算出 $f(0)$，即得到秘密 $s$。

需要注意的是，如果只有两个参与者想要重建秘密，他们只能得到一个一次多项式，无法得到秘密 $s$。只有在有至少三个参与者时才能恢复出秘密。

## Key Agreement

用于实现私有聚合协议的密钥协商部分。

在这个协议中，假设有n个客户端参与计算，服务器希望在不暴露客户端数据的情况下聚合客户端数据。协议的目标是生成一个用于加密通信的对称密钥，该密钥只能由服务器和客户端共享。

具体来说，协议步骤如下：

1. 服务器随机生成一个大素数 p 和一个生成元 g，将它们公开。
2. 每个客户端随机生成一个私有值 x_i，并计算对应的公开值 y_i = g^x_i mod p。
3. 每个客户端将公开值 y_i 发送给服务器。
4. 服务器收到所有公开值 y_i 后，计算密钥协商值 K = g^(∑_i(x_i)) mod p，其中∑_i(x_i)表示所有客户端私有值 x_i 的总和。                        **（g^(∑_i(x_i)) = g^(x_1 + x_2 + ... + x_n) = g^(x_1) * g^(x_2) * ... * g^(x_n) = y_1 * y_2 * ... * y_n）**
5. 服务器使用 K 加密聚合结果，并将加密结果发送回每个客户端。（**此处的聚合结果可以是明文，也可以是某种加密过的结果**）
6. 每个客户端使用自己的私有值 x_i 解密聚合结果。

在这个协议中，每个客户端都只公开了公开值 y_i，而没有公开私有值 x_i。由于计算密钥协商值 K 需要所有客户端的私有值 x_i 的总和，而每个客户端只知道自己的私有值，因此客户端无法获得 K。同时，由于 g 和 p 是公开的，攻击者也无法通过 y_i 推导出 x_i 或 K，从而保证了协议的安全性。

在第5步中，服务器使用密钥协商值 K 加密聚合结果，因此只有服务器和每个客户端才能解密聚合结果，从而保证了聚合结果的保密性。

需要注意的是，在实际应用中，可能需要采取一些措施来防止其他攻击，比如使用防重放攻击的协议或者使用不同的 p 和 g。